# Работа со встроенным принтером чеков

Все модели смарт-терминалов оборудованы встроенным принтером чеков, который используется для:

* печати различных типов документов: Z-отчёта и чеков;
* печати произвольных данных (текста, изображений, штрихкодов или QR-кодов) на чековой ленте.

В зависимости от того как ваше приложение будет использовать встроенный принтер чеков, оно должно обладать необходимыми разрешениями.

## Поддерживаемы данные

На встроенном принтере можно печатать следующие данные:

* Штрихкоды (в том числе QR-коды);
* Изображения (**какие есть ограничения?**)
* Текст (**какие есть ограничения?**)

{% include tip.html content="При печати текста или изображений вам помогут методы getAllowableSymbolsLineLength (возвращает количество символов, которые помещаются в одной строке чека) и getAllowablePixelLineLength (возвращает доступную для печати ширину бумаги в пикселях)." %}

## Разрешение

Для печати произвольных данных на чековой ленте (как без привязки к документу, так и внутри кассового чека), в [манифесте приложения](./ссылка на файл манифеста) необходимо объявить разрешение:

```xml
<uses-permission android:name="ru.evotor.permission.receipt.printExtra.SET" />
```

{% include note.html content="Для печати Z-отчётов [используется другое разрешение](./doc_java_z_report.html#permission), а для печати чеков коррекции указывать разрешение не надо вовсе." %}

## Печать произвольных данных на чековой ленте

Ваше приложение может печатать произвольные данные на чековой ленте без привязки к каким-либо документам.

*Чтобы печатать произвольные данные на чековой ленте:*

1. В методе обратного вызова `onCreate()` инициализируйте принтер чеков, с помощью класса [`DeviceServiceConnector`](./ДОБАВИТЬ JAVADOC):

   ```java
   DeviceServiceConnector.startInitConnections(getApplicationContext());
   ```

   Класс инициализируется асинхронно, чтобы не препятствовать вызывающему потоку.

   {% include tip.html content="Воспользуйтесь методом `addConnectionWrapper`, чтобы получить событие об успешном подключении. <br/><br/>

   Используйте это событие, если необходимо выполнить какой-либо код сразу после установки соединения." %}

2. Вызовите метод [`getPrinterService()`](./ДОБАВИТЬ JAVADOC).
3. Напечатайте необходимые данные с помощью метода `printDocument(int deviceId, in PrinterDocument printerDocument)`.

    Аргумент `PrinterDocument` содержит список элементов печати `IPrintable`:

    * Тексты – `ru.evotor.devices.commons.printer.printable.PrintableText`;
    * Штрихкоды – `ru.evotor.devices.commons.printer.printable.PrintableBarcode`;
    * Картинки – `ru.evotor.devices.commons.printer.printable.PrintableImage`.

## Печать данных внутри кассового чека

Ваше приложение может печатать произвольные данные внутри чеков, которые сопровождают продажу, возврат, а также покупку и возврат покупки.

*

## См. также

* Печать Z-отчёта
* Печать чека коррекции
